{"ast":null,"code":"import{create}from'zustand';import{authAPI}from'../api/client';export const useAuthStore=create(set=>({user:null,token:localStorage.getItem('token'),isLoading:false,error:null,setUser:user=>set({user}),setToken:token=>{if(token){localStorage.setItem('token',token);}else{localStorage.removeItem('token');}set({token});},setError:error=>set({error}),setLoading:loading=>set({isLoading:loading}),register:async data=>{set({isLoading:true,error:null});try{const response=await authAPI.register(data);const{token,refreshToken,user}=response.data;set({token,user,isLoading:false});localStorage.setItem('token',token);localStorage.setItem('refreshToken',refreshToken);return response.data;}catch(error){var _error$response,_error$response$data;const errorMsg=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Registration failed';set({error:errorMsg,isLoading:false});throw error;}},login:async data=>{set({isLoading:true,error:null});try{const response=await authAPI.login(data);const{token,refreshToken,user}=response.data;set({token,user,isLoading:false});localStorage.setItem('token',token);localStorage.setItem('refreshToken',refreshToken);return response.data;}catch(error){var _error$response2,_error$response2$data;const errorMsg=((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Login failed';set({error:errorMsg,isLoading:false});throw error;}},logout:()=>{localStorage.removeItem('token');localStorage.removeItem('refreshToken');set({user:null,token:null});},fetchProfile:async()=>{set({isLoading:true});try{const response=await authAPI.getProfile();set({user:response.data,isLoading:false});return response.data;}catch(error){set({error:'Failed to fetch profile',isLoading:false});throw error;}},updateProfile:async data=>{set({isLoading:true,error:null});try{const response=await authAPI.updateProfile(data);set({user:response.data,isLoading:false});return response.data;}catch(error){set({error:'Failed to update profile',isLoading:false});throw error;}},isAuthenticated:()=>{const token=localStorage.getItem('token');return!!token;}}));","map":{"version":3,"names":["create","authAPI","useAuthStore","set","user","token","localStorage","getItem","isLoading","error","setUser","setToken","setItem","removeItem","setError","setLoading","loading","register","data","response","refreshToken","_error$response","_error$response$data","errorMsg","message","login","_error$response2","_error$response2$data","logout","fetchProfile","getProfile","updateProfile","isAuthenticated"],"sources":["C:/biznez/frontend/src/store/authStore.js"],"sourcesContent":["import { create } from 'zustand';\r\nimport { authAPI } from '../api/client';\r\n\r\nexport const useAuthStore = create((set) => ({\r\n  user: null,\r\n  token: localStorage.getItem('token'),\r\n  isLoading: false,\r\n  error: null,\r\n\r\n  setUser: (user) => set({ user }),\r\n  setToken: (token) => {\r\n    if (token) {\r\n      localStorage.setItem('token', token);\r\n    } else {\r\n      localStorage.removeItem('token');\r\n    }\r\n    set({ token });\r\n  },\r\n  setError: (error) => set({ error }),\r\n  setLoading: (loading) => set({ isLoading: loading }),\r\n\r\n  register: async (data) => {\r\n    set({ isLoading: true, error: null });\r\n    try {\r\n      const response = await authAPI.register(data);\r\n      const { token, refreshToken, user } = response.data;\r\n      set({\r\n        token,\r\n        user,\r\n        isLoading: false,\r\n      });\r\n      localStorage.setItem('token', token);\r\n      localStorage.setItem('refreshToken', refreshToken);\r\n      return response.data;\r\n    } catch (error) {\r\n      const errorMsg = error.response?.data?.message || 'Registration failed';\r\n      set({ error: errorMsg, isLoading: false });\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  login: async (data) => {\r\n    set({ isLoading: true, error: null });\r\n    try {\r\n      const response = await authAPI.login(data);\r\n      const { token, refreshToken, user } = response.data;\r\n      set({\r\n        token,\r\n        user,\r\n        isLoading: false,\r\n      });\r\n      localStorage.setItem('token', token);\r\n      localStorage.setItem('refreshToken', refreshToken);\r\n      return response.data;\r\n    } catch (error) {\r\n      const errorMsg = error.response?.data?.message || 'Login failed';\r\n      set({ error: errorMsg, isLoading: false });\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  logout: () => {\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('refreshToken');\r\n    set({ user: null, token: null });\r\n  },\r\n\r\n  fetchProfile: async () => {\r\n    set({ isLoading: true });\r\n    try {\r\n      const response = await authAPI.getProfile();\r\n      set({ user: response.data, isLoading: false });\r\n      return response.data;\r\n    } catch (error) {\r\n      set({ error: 'Failed to fetch profile', isLoading: false });\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  updateProfile: async (data) => {\r\n    set({ isLoading: true, error: null });\r\n    try {\r\n      const response = await authAPI.updateProfile(data);\r\n      set({ user: response.data, isLoading: false });\r\n      return response.data;\r\n    } catch (error) {\r\n      set({ error: 'Failed to update profile', isLoading: false });\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  isAuthenticated: () => {\r\n    const token = localStorage.getItem('token');\r\n    return !!token;\r\n  },\r\n}));\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}